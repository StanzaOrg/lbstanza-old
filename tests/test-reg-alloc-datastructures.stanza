#use-added-syntax(tests)
defpackage stz-test-suite/test-reg-alloc-datastructures :
  import core
  import collections
  import stz/reg-alloc-datastructures
  import stz/reg-alloc-assignment-table
  import stz/reg-alloc-ir

deftest bitset :
  val s = BitSet(256)
  for x in [0, 3, 7, 11, 34, 31, 64, 65, 66, 100, 101, 127, 129, 130, 156, 2, 1, 1, 1, 167, 138] do :
    add(s, x)
  println(s)

within (package,sig) = set-stack-trace-filter() :
  package != `core

let :
  val table = AssignmentTable(ResourceProvider(8, 8, 20))

  ;Save a bunch of variables.
  set-saved(table, 0, true)
  set-saved(table, 2, true)
  set-saved(table, 7, true)
  set-saved(table, 2, false)
  set-saved(table, 17, true)
  println(table)
