defpackage stz/reg-alloc-simple-model-env :
  import core
  import collections
  import stz/reg-alloc-ir
  import stz/reg-alloc-model-env

public defn SimpleModelEnv (models:Tuple<OperationModel>) -> ModelEnv :
  ;Verify model indexing.
  for (m in models, i in 0 to false) do :
    if id(m) != i :
      fatal("Models are not densely indexed.")
  new ModelEnv :
    defmethod num-models (this) :
      length(models)
    defmethod model (this, id:Int) :
      models[id]
    defmethod arg-types (this, id:Int) :
      map(type{location(_)}, args(models[id]))
    defmethod result-types (this, id:Int) :
      map(type{location(_)}, results(models[id]))