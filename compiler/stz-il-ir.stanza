defpackage stz/il-ir :
   import core
   import verse
   import stz/forms
   import stz/namemap

;============================================================
;================= Stanza Language ==========================
;============================================================

public definterface IExp
public defmulti info (e:IExp) -> FileInfo
public defmulti set-info (e:IExp, i:FileInfo) -> False

;======== Package Forms ========
   
public defstruct IPackage :
   name: Symbol
   imports: List<IImport>
   info: FileInfo with :
      as-method => true
      setter => set-info

public defstruct IImport :
   package: Symbol
   prefix: List<IPrefix>
   info: FileInfo with :
      as-method => true
      setter => set-info

public defstruct IPrefix :
   names: False|List<Symbol>
   prefix: Symbol
   info: FileInfo with :
      as-method => true
      setter => set-info
   
public defstruct IExport :
   exp: IExp
   info: FileInfo with :
      as-method => true
      setter => set-info

;======== Declaration Forms ========

public defstruct IDefType :
   class: IRef
   args: List<IRef>
   parent: IExp
   info: FileInfo with :
      as-method => true
      setter => set-info
   
public defstruct IDef :
   name: IExp
   type: IExp
   value: IExp
   info: FileInfo with :
      as-method => true
      setter => set-info
   
public defstruct IDefVar :
   name: Symbol
   type: IExp
   value: IExp
   info: FileInfo with :
      as-method => true
      setter => set-info

public defstruct IDefn :
   name: Symbol
   targs: List<IRef>
   func: IFn
   info: FileInfo with :
      as-method => true
      setter => set-info
   
public defstruct IDefmulti :
   name: Symbol
   targs: List<IRef>
   a1: List<IExp>
   a2: IExp
   info: FileInfo with :
      as-method => true
      setter => set-info

public defstruct IDefmethod :
   func: Symbol
   this-var: False|Symbol
   targs: List<IRef>
   func: IFn
   info: FileInfo with :
      as-method => true
      setter => set-info

;======== Expression Forms ========

public defstruct IFn :
   tail?: True|False
   a1: List<IExp>
   a2: IExp
   args: List<IExp>
   body: IExp
   info: FileInfo with :
      as-method => true
      setter => set-info

public defstruct IMulti :
   funcs: List<IFn>
   info: FileInfo with :
      as-method => true
      setter => set-info
   
public defstruct IBegin :
   exps: List<IExp>
   info: FileInfo with :
      as-method => true
      setter => set-info

public defstruct IMatch :
   args: List<IExp>
   branches: List<IBranch>
   info: FileInfo with :
      as-method => true
      setter => set-info
   
public defstruct IBranch :
   types: List<IExp>
   args: List<IExp>
   body: IExp
   info: FileInfo with :
      as-method => true
      setter => set-info

public defstruct INew :
   class: IExp
   methods: List<IDefmethod>
   info: FileInfo with :
      as-method => true
      setter => set-info  

public defstruct IRef :
   name: Symbol
   info: FileInfo with :
      as-method => true
      setter => set-info

public defstruct ICast :
   exp: IExp
   type: IExp
   info: FileInfo with :
      as-method => true
      setter => set-info
   
public defstruct ISet :
   name: Symbol
   value: IExp
   info: FileInfo with :
      as-method => true
      setter => set-info

public defstruct IDo :
   func: IExp
   targs: List<IExp>
   args: List<IExp>
   info: FileInfo with :
      as-method => true
      setter => set-info

public defstruct IDoPrim :
   function: Symbol
   args: List<IExp>
   info: FileInfo with :
      as-method => true
      setter => set-info

public defstruct ICallLS :
   function: Symbol
   targs: List<IExp>
   args: List<IExp>
   info: FileInfo with :
      as-method => true
      setter => set-info
   
public defstruct ILiteral :
   value
   info: FileInfo with :
      as-method => true
      setter => set-info

public defstruct ITuple :
   exps: List<IExp>
   info: FileInfo with :
      as-method => true
      setter => set-info
   
;======== Type Forms ========

public defstruct IOf :
   class: IExp
   args: List<IExp>
   info: FileInfo with :
      as-method => true
      setter => set-info

public defstruct IAnd :
   a: IExp
   b: IExp
   info: FileInfo with :
      as-method => true
      setter => set-info

public defstruct IOr :
   a: IExp
   b: IExp
   info: FileInfo with :
      as-method => true
      setter => set-info

public defstruct IArrow :
   a1: List<IExp>
   a2: IExp
   info: FileInfo with :
      as-method => true
      setter => set-info

public defstruct ICap :
   name: Symbol
   info: FileInfo with :
      as-method => true
      setter => set-info

public defstruct IGradual :
   info: FileInfo with :
      as-method => true
      setter => set-info
   
public defstruct IVoid :
   info: FileInfo with :
      as-method => true
      setter => set-info

public defstruct INone :
   info: FileInfo with :
      as-method => true
      setter => set-info

;============================================================
;================== LoStanza Language =======================
;============================================================

;======== Expression Forms ========