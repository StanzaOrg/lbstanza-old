defpackage stz/reg-alloc-checks :
  import core
  import collections
  import stz/reg-alloc-engine

;Ensure that no blocks exist.
public defn no-blocks! (e:RegAllocEngine) :
  if not empty?(blocks(e)) :
    fatal("Blocks are expected to be empty.")

;Ensure f on each block.
public defn each-block (f:Block -> ?, e:RegAllocEngine) :
  do(f, blocks(e))

;Ensure that block as no inputs.
public defn no-inputs! (b:Block) :
  if not empty?(inputs(b)) :
    fatal("Block input is not empty.")

;Ensure that block as no outputs.
public defn no-outputs! (b:Block) :
  if not empty?(outputs(b)) :
    fatal("Block output is not empty.")

;Ensure that block as no defs.
public defn no-defs! (b:Block) :
  if not empty?(defs(b)) :
    fatal("Block defs is not empty.")